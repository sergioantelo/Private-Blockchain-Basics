<!-- extend base layout -->
{% extends "base.html" %}

{% block content %}
	<br>
	<div class="container">
		<div class="left">
			<div class="transaction">
				<form action="/submit" id="textform" method="post">
					<center><h3>Submit a Transaction</h3></center>
					<center>
					<textarea name="content" rows="4" cols="50" placeholder="Certificate content..."></textarea>
					
					<br><br>
		
					<input type="text" name="author" placeholder="Candidate">
					<input type="submit" value="Post">
					</center>
					<br>
				</form>
				<center>
				<a href="/mine_app"><button>Request to mine</button></a>
				<a href="/"><button>Resync</button></a>
				</center>
			</div>

			<div class='blockchain'>
				<center><h3>Pending Txs</h3></center>
				{% for tx in txs %}
				<div class="post_box">
					<p>Author: {{tx.author}}</p>
					<p>Timestamp: <i>{{readable_time(tx.timestamp)}}</i></p>
					<p>Content: {{tx.content}}</p>
				</div>
				{% endfor %}
				
				<center><h3>Blockchain</h3></center>
				{% for post in posts[::-1] %}
				<div class="post_box">
					<div class="post_box-header">
						<div style="background: rgb(0, 97, 146) none repeat scroll 0% 0%; box-shadow: rgb(0, 97, 146) 0px 0px 0px 2px;" class="post_box-avatar">{{post.index}}</div>
						<div class="name-header"><b>Block #{{post.index}}</b></div>
						<div class="name-header"><b>Miner:</b> {{post.miner}}</div>
						<div class="name-header"><b>Hash:</b> {{post.hash}}</div>
						<div class="name-header" style="padding-left:56px"><b>Prev Hash:</b> {{post.previous_hash}}</div>
						<div class="name-header" style="padding-left:56px"><b>Nonce:</b> {{post.nonce}}</div>
					{% for p in post.transactions %}
					<div class="post_box-body">
						<p>Author: {{p.author}}</p>
						<p>Timestamp: <i>{{readable_time(p.timestamp)}}</i></p>
						<p>Content: {{p.content}}</p>
					</div>
					{% endfor %}
					</div>
				</div>
				{% endfor %}
			</div>
		</div>
		<div class="right">
			<div class="function">
				<form action="/search" id="textform" method="post">
					<center><h3>Search a Document</h3></center>
					<center>
					<textarea name="content" rows="2" cols="50" placeholder="Input a transaction..."></textarea>
					</center>
		
					<p><b> Output:</b> {{answer}}</p>
		
					<br>
		
					<center>
					<input type="submit" value="Search">
					</center>
					<br>
				</form>
			</div>
			<div class="function">
				<form action="/modify_diff" id="textform" method="post">
					<center><h3>Modify the Difficulty</h3></center>
					<center>
					<textarea name="difficulty" rows="2" cols="50" placeholder="Input the desired difficulty..."></textarea>
					</center>
		
					<p><b> Difficulty set to:</b> {{difficulty}}</p>
		
					<br>
		
					<center>
					<input type="submit" value="Change">
					</center>
				</form>
			</div>
			<div class="function">
				<form action="/switch_node" id="textform" method="post">
					<center><h3>Switch Connected Node</h3></center>
					<center>
					<textarea name="node" rows="2" cols="50" placeholder="Input the new node..."></textarea>
					</center>
		
					<p><b> Connected node:</b> {{connected_node}}</p>
		
					<br>
		
					<center>
					<input type="submit" value="Switch">
					</center>
				</form>
			</div>
			<div class="function">
				<form action="/add_new_node" id="textform" method="post">
					<center><h3>Add New Node</h3></center>
					<center>
					<textarea name="new_node" rows="2" cols="50" placeholder="Input the new node..."></textarea>
					</center>
		
					<p><b> New node added:</b> {{new_node}}</p>
		
					<br>
		
					<center>
					<input type="submit" value="Add">
					</center>
				</form>
			</div>
			<div class="function">
				<form action="/reg_with" id="textform" method="post">
					<center><h3>Register Nodes</h3></center>
					<center>
					<textarea name="node1" rows="2" cols="50" placeholder="Input the base node..."></textarea>
					<p>with</p>
					<textarea name="list_nodes" rows="2" cols="50" placeholder="Input the register with node..."></textarea>
					</center>
		
					<p><b> Output:</b> {{register}}</p>
		
					<br>
		
					<center>
					<input type="submit" value="Register">
					</center>
				</form>
			</div>
			<div class="function">
				<form action="/tampered_block" id="textform" method="post">
					<center><h3>Tampered Block Attack</h3></center>
					<center>
						<input type="submit" value="Simulate Previous Hash Attack">
					</center>

					<br>

					<p><b> Response:</b> {{attack.text}}</p>
				</form>
			</div>
		</div>
	</div>
	
	<style>
		.container {
			height: auto;
			overflow: hidden;
		}

		.right {
			width: 510px;
			float: right;
			background: #fff;
		}

		.left {
			float: left; /* not needed, just for clarification */
			background: #fff;
			/* the next props are meant to keep this block independent from the other floated one */
			width: auto;
			overflow: hidden;
		}​​

		.blockchain {
		    background: #fff;
		    padding: 12px 0px 0px 8px;
			border-style: groove;
			margin-left: 10px;
		}

		.transaction {
			background: #fff;
			padding: 0px 2px 20px 2px;
			margin-left: 120px;
			margin-right: 120px;
			margin-bottom: 40px;
			border-style: groove;
		}

		.function {
			background: #fff;
			margin-right: 80px;
			margin-bottom: 10px;
			border-style: groove;
		}

		.post_box {
		    background: #fff;
		    padding: 12px 6px 0px 12px;
		    margin-top: 0px;
		    margin-bottom: 8px;
			margin-right: 12px;
			border-style: ridge;
		}

		.post_box-header {
		    padding-bottom: 12px;
		}

		.post_box-avatar {
		    width: 38px;
		    height: 38px;
		    border-radius: 50%;
		    display: flex;
		    justify-content: center;
		    align-items: center;
		    color: white;
		    font-size: 22px;
		    float: left;
		    margin-right: 16px;
		    border: 1px solid #fff;
		    box-shadow: 0px 0px 0px 2px #f00;
		}

		.post_box-avatar::after {
		    content:"";
		    display:block;
		}

		.post_box-name {
		    font-weight: bold;
		}

		.post_box-subtitle {
		    color: #777;
		}

		.post_box-body {
		    margin-top: 32px;
		    margin-bottom: 8px;
			margin-right: 12px;
			padding: 8px 0px 0px 12px;
			border-style: ridge;
		}

		.post_box-options {
		    float: right;
		}
		.option-btn {
		    background: #f8f8f8;
		    border: none;
		    color: #2c3e50;
		    padding: 7px;
		    cursor: pointer;
		    font-size: 14px;
		    margin-left: 2px;
		    margin-right: 2px;
		    outline: none;
		    height: 42px;
		}
	</style>

{% endblock %}